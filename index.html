<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>PFP Generator Preview</title>

  <style>
    body {
      margin: 0;
      padding: 40px;
      background: #111;
      color: #fff;
      font-family: sans-serif;
      text-align: center;
    }

    button {
      padding: 14px 24px;
      font-size: 16px;
      cursor: pointer;
      border: none;
      border-radius: 6px;
    }

    canvas {
      display: block;
      margin: 30px auto;
      width: 320px;
      height: 320px;
      border-radius: 12px;
      background: #222;
    }
  </style>
</head>

<body>

  <button id="generate">Generate</button>
  <canvas id="canvas" width="2024" height="2024"></canvas>

<script>
/* ==========================
   CONFIG â€” CHANGE ONLY THESE
========================== */

const GITHUB_USERNAME = "daresum";
const GITHUB_REPO = "PFPGen";
const GITHUB_BRANCH = "main";

/* ==========================
   DO NOT CHANGE BELOW
========================== */

const CDN_BASE = `https://cdn.jsdelivr.net/gh/daresum/PFPGen/layers`;

/* Layer order = draw order */
const LAYERS = [
  { name: "background", files: ["blue.png", "green.png", "pink.png"] },
  { name: "base", files: ["base.png"], fixed: true },
  { name: "body", files: ["artist.png", "broken.png"] },
  { name: "head", files: ["cap.png", "wizard.png"] },
  { name: "mouth", files: ["aaa.png", "car.png"] },
  { name: "eyes", files: ["agent.png", "anime.png"] }
];

function randomItem(arr) {
  return arr[Math.floor(Math.random() * arr.length)];
}

function loadImage(src) {
  return new Promise((resolve, reject) => {
    const img = new Image();
    img.crossOrigin = "anonymous";
    img.onload = () => resolve(img);
    img.onerror = () => reject(`Failed to load ${src}`);
    img.src = src;
  });
}

async function generatePFP() {
  const canvas = document.getElementById("canvas");
  const ctx = canvas.getContext("2d");
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  for (const layer of LAYERS) {
    const file = layer.fixed
      ? layer.files[0]
      : randomItem(layer.files);

    const img = await loadImage(
      `${CDN_BASE}/${layer.name}/${file}`
    );

    ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
  }
}

document.getElementById("generate").addEventListener("click", generatePFP);
</script>

</body>
</html>
